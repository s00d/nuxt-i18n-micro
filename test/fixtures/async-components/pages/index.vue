<template>
  <div>
    <h1>{{ $t('index::title') }}</h1>
    <p>{{ $t('index::description') }}</p>

    <!-- ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ Ðº Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¼ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°Ð¼ -->
    <div class="navigation">
      <i18n-link
        to="/async-components-test"
        class="nav-link"
      >
        {{ $t('index::navigation.test1') }}
      </i18n-link>
      <i18n-link
        to="/async-components-test-2"
        class="nav-link"
      >
        {{ $t('index::navigation.test2') }}
      </i18n-link>
    </div>

    <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ð»Ð¾ÐºÐ°Ð»Ð¸ -->
    <div class="locale-info">
      <p><strong>{{ $t('index::localeInfo.currentLocale') }}:</strong> {{ $getLocale() }}</p>
      <p><strong>{{ $t('index::localeInfo.routeName') }}:</strong> {{ $getRouteName() }}</p>
    </div>

    <!-- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ·Ñ‹ÐºÐ¾Ð² -->
    <div class="language-switcher">
      <h3>{{ $t('index::switchLanguage') }}</h3>
      <div class="switcher-buttons">
        <button
          v-for="locale in availableLocales"
          :key="locale.code"
          :class="{ active: $getLocale() === locale.code }"
          class="locale-button"
          @click="switchToLocale(locale.code)"
        >
          {{ locale.name }}
        </button>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { useNuxtApp } from '#imports'

const { $defineI18nRoute, $getLocale, $getRouteName, $switchLocale, $t } = useNuxtApp()

// ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
$defineI18nRoute({
  locales: {
    en: {
      'index::title': 'Async Components Test Suite',
      'index::description': 'Testing async components with i18n translations',
      'index::navigation.test1': 'ðŸ§ª Async Components Test 1',
      'index::navigation.test2': 'ðŸ§ª Async Components Test 2',
      'index::localeInfo.currentLocale': 'Current Locale',
      'index::localeInfo.routeName': 'Route Name',
      'index::switchLanguage': 'Switch Language',
    },
    ru: {
      'index::title': 'ÐÐ°Ð±Ð¾Ñ€ Ð¢ÐµÑÑ‚Ð¾Ð² ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð²',
      'index::description': 'Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð² Ñ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð°Ð¼Ð¸ i18n',
      'index::navigation.test1': 'ðŸ§ª Ð¢ÐµÑÑ‚ ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð² 1',
      'index::navigation.test2': 'ðŸ§ª Ð¢ÐµÑÑ‚ ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð² 2',
      'index::localeInfo.currentLocale': 'Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð›Ð¾ÐºÐ°Ð»ÑŒ',
      'index::localeInfo.routeName': 'Ð˜Ð¼Ñ ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚Ð°',
      'index::switchLanguage': 'ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¯Ð·Ñ‹Ðº',
    },
    de: {
      'index::title': 'Async-Komponenten Test-Suite',
      'index::description': 'Testen von Async-Komponenten mit i18n-Ãœbersetzungen',
      'index::navigation.test1': 'ðŸ§ª Async-Komponenten Test 1',
      'index::navigation.test2': 'ðŸ§ª Async-Komponenten Test 2',
      'index::localeInfo.currentLocale': 'Aktuelle Lokale',
      'index::localeInfo.routeName': 'Routenname',
      'index::switchLanguage': 'Sprache Wechseln',
    },
  },
})

// Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð»Ð¾ÐºÐ°Ð»Ð¸
const availableLocales = [
  { code: 'en', name: 'English' },
  { code: 'ru', name: 'Ð ÑƒÑÑÐºÐ¸Ð¹' },
  { code: 'de', name: 'Deutsch' },
]

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ ÑÐ·Ñ‹ÐºÐ°
const switchToLocale = async (locale: string) => {
  try {
    await $switchLocale(locale)
  }
  catch (error) {
    console.error('Error switching locale:', error)
  }
}
</script>

<style scoped>
.navigation {
  margin: 30px 0;
  padding: 20px;
  background: #ecf0f1;
  border-radius: 8px;
  text-align: center;
}

.nav-link {
  display: inline-block;
  margin: 0 10px;
  padding: 10px 20px;
  background: #3498db;
  color: white;
  text-decoration: none;
  border-radius: 5px;
  transition: background 0.3s;
}

.nav-link:hover {
  background: #2980b9;
}

.locale-info {
  margin: 20px 0;
  padding: 15px;
  background: #f8f9fa;
  border-radius: 8px;
}

.language-switcher {
  margin: 30px 0;
  padding: 20px;
  background: #f5f5f5;
  border-radius: 8px;
}

.switcher-buttons {
  display: flex;
  gap: 10px;
  justify-content: center;
  flex-wrap: wrap;
}

.locale-button {
  padding: 8px 16px;
  background: #95a5a6;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.3s;
}

.locale-button:hover {
  background: #7f8c8d;
}

.locale-button.active {
  background: #27ae60;
}

.locale-button.active:hover {
  background: #229954;
}
</style>
