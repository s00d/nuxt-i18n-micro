import{_ as d}from"./chunks/plugin-vue_export-helper.DlAUqK2U.js";import{A as c,b as h,k as i,ah as s,e as o,m as a,l,g as n,ai as r}from"./chunks/chartjs.CT3i_C7A.js";const F=JSON.parse('{"title":"üóÇÔ∏è Routing Strategies in Nuxt I18n Micro","description":"","frontmatter":{},"headers":[],"relativePath":"guide/strategy.md","filePath":"guide/strategy.md","lastUpdated":1771267168000}'),p={name:"guide/strategy.md"};function k(g,e,u,E,y,f){const t=c("Mermaid");return i(),h("div",null,[e[2]||(e[2]=s('<h1 id="üóÇÔ∏è-routing-strategies-in-nuxt-i18n-micro" tabindex="-1">üóÇÔ∏è Routing Strategies in Nuxt I18n Micro <a class="header-anchor" href="#üóÇÔ∏è-routing-strategies-in-nuxt-i18n-micro" aria-label="Permalink to &quot;üóÇÔ∏è Routing Strategies in Nuxt I18n Micro&quot;">‚Äã</a></h1><h2 id="üìñ-overview" tabindex="-1">üìñ Overview <a class="header-anchor" href="#üìñ-overview" aria-label="Permalink to &quot;üìñ Overview&quot;">‚Äã</a></h2><p>Nuxt I18n Micro controls how locale prefixes appear in URLs through the <code>strategy</code> option. Under the hood, two packages implement this:</p><ul><li><strong><code>@i18n-micro/route-strategy</code></strong> ‚Äî build-time route generation (extends Nuxt pages with localized routes)</li><li><strong><code>@i18n-micro/path-strategy</code></strong> ‚Äî runtime path resolution, redirects, SEO attributes, and link generation</li></ul><p>The Nuxt module selects the correct strategy class at build time and aliases it via <code>#i18n-strategy</code>, so only the chosen implementation is bundled.</p><h2 id="üö¶-available-strategies" tabindex="-1">üö¶ Available Strategies <a class="header-anchor" href="#üö¶-available-strategies" aria-label="Permalink to &quot;üö¶ Available Strategies&quot;">‚Äã</a></h2><p><strong>Type</strong>: <code>string</code><strong>Default</strong>: <code>&#39;prefix_except_default&#39;</code></p><h3 id="strategy-comparison" tabindex="-1">Strategy Comparison <a class="header-anchor" href="#strategy-comparison" aria-label="Permalink to &quot;Strategy Comparison&quot;">‚Äã</a></h3>',8)),(i(),o(r,null,{default:a(()=>[n(t,{id:"mermaid-33",class:"mermaid-chart",graph:"flowchart%20LR%0A%20%20%20%20subgraph%20no_prefix%5B%22no_prefix%22%5D%0A%20%20%20%20%20%20%20%20N1%5B%22%2Fabout%22%5D%20--%3E%20N2%5B%22Any%20locale%22%5D%0A%20%20%20%20%20%20%20%20N3%5B%22%2Fcontact%22%5D%20--%3E%20N2%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20prefix_except_default%5B%22prefix_except_default%22%5D%0A%20%20%20%20%20%20%20%20P1%5B%22%2Fabout%22%5D%20--%3E%20P2%5B%22Default%20(en)%22%5D%0A%20%20%20%20%20%20%20%20P3%5B%22%2Ffr%2Fabout%22%5D%20--%3E%20P4%5B%22French%22%5D%0A%20%20%20%20%20%20%20%20P5%5B%22%2Fde%2Fabout%22%5D%20--%3E%20P6%5B%22German%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20prefix%5B%22prefix%22%5D%0A%20%20%20%20%20%20%20%20X1%5B%22%2Fen%2Fabout%22%5D%20--%3E%20X2%5B%22English%22%5D%0A%20%20%20%20%20%20%20%20X3%5B%22%2Ffr%2Fabout%22%5D%20--%3E%20X4%5B%22French%22%5D%0A%20%20%20%20%20%20%20%20X5%5B%22%2Fde%2Fabout%22%5D%20--%3E%20X6%5B%22German%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20prefix_and_default%5B%22prefix_and_default%22%5D%0A%20%20%20%20%20%20%20%20A1%5B%22%2Fabout%22%5D%20--%3E%20A2%5B%22Default%20(en)%22%5D%0A%20%20%20%20%20%20%20%20A3%5B%22%2Fen%2Fabout%22%5D%20--%3E%20A2%0A%20%20%20%20%20%20%20%20A5%5B%22%2Ffr%2Fabout%22%5D%20--%3E%20A6%5B%22French%22%5D%0A%20%20%20%20end%0A"})]),fallback:a(()=>[...e[0]||(e[0]=[l(" Loading... ",-1)])]),_:1})),e[3]||(e[3]=s(`<h3 id="üõë-no-prefix" tabindex="-1">üõë <code>no_prefix</code> <a class="header-anchor" href="#üõë-no-prefix" aria-label="Permalink to &quot;üõë \`no_prefix\`&quot;">‚Äã</a></h3><p>URLs have no locale segment. Locale is determined by cookies, <code>useI18nLocale()</code> state, or browser detection.</p><ul><li><strong>Routes</strong>: <code>/about</code>, <code>/contact</code> ‚Äî same URL for all locales</li><li><strong>Locale persistence</strong>: Via <code>localeCookie</code> (automatically set to <code>&#39;user-locale&#39;</code> if not specified)</li><li><strong>Restrictions</strong>: Does not support custom paths or route-level locale restrictions</li></ul><div class="tip custom-block"><p class="custom-block-title">Automatic <code>localeCookie</code></p><p>When using <code>no_prefix</code>, <code>localeCookie</code> is automatically set to <code>&#39;user-locale&#39;</code> if not specified. This is required because the URL contains no locale information.</p></div><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;no_prefix&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // localeCookie is automatically set to &#39;user-locale&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="üöß-prefix-except-default" tabindex="-1">üöß <code>prefix_except_default</code> <a class="header-anchor" href="#üöß-prefix-except-default" aria-label="Permalink to &quot;üöß \`prefix_except_default\`&quot;">‚Äã</a></h3><p>All routes have a locale prefix <strong>except</strong> the default locale.</p><ul><li><strong>Default locale</strong>: <code>/about</code>, <code>/contact</code></li><li><strong>Other locales</strong>: <code>/fr/about</code>, <code>/de/contact</code></li><li><strong>Default locale with prefix returns 404</strong>: <code>/en/about</code> ‚Üí 404 (when <code>en</code> is default)</li></ul><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;prefix_except_default&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // This is the default</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="üåç-prefix" tabindex="-1">üåç <code>prefix</code> <a class="header-anchor" href="#üåç-prefix" aria-label="Permalink to &quot;üåç \`prefix\`&quot;">‚Äã</a></h3><p>Every route has a locale prefix, including the default locale.</p><ul><li><strong>All locales</strong>: <code>/en/about</code>, <code>/fr/about</code>, <code>/de/about</code></li><li><strong>Root <code>/</code></strong>: Redirects to <code>/{locale}/</code> based on user preference</li></ul><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;prefix&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="üîÑ-prefix-and-default" tabindex="-1">üîÑ <code>prefix_and_default</code> <a class="header-anchor" href="#üîÑ-prefix-and-default" aria-label="Permalink to &quot;üîÑ \`prefix_and_default\`&quot;">‚Äã</a></h3><p>Default locale is available both with and without prefix. Non-default locales always have a prefix.</p><ul><li><strong>Default locale</strong>: both <code>/about</code> and <code>/en/about</code> are valid</li><li><strong>Other locales</strong>: <code>/fr/about</code>, <code>/de/about</code></li><li><strong>No redirect from <code>/</code></strong>: Both <code>/</code> and <code>/en/</code> serve the default locale</li></ul><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;prefix_and_default&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="üîÄ-redirect-architecture-v3" tabindex="-1">üîÄ Redirect Architecture (v3) <a class="header-anchor" href="#üîÄ-redirect-architecture-v3" aria-label="Permalink to &quot;üîÄ Redirect Architecture (v3)&quot;">‚Äã</a></h2><p>In v3, redirect logic is split into two layers for optimal performance:</p><h3 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">‚Äã</a></h3>`,20)),(i(),o(r,null,{default:a(()=>[n(t,{id:"mermaid-139",class:"mermaid-chart",graph:"flowchart%20TB%0A%20%20%20%20A%5B%22Request%22%5D%20--%3E%20B%7BServer%20or%20Client%3F%7D%0A%0A%20%20%20%20B%20--%3E%7CServer%20SSR%7C%20C%5B%22Nitro%20Middleware%3Cbr%2F%3Ei18n.global.ts%22%5D%0A%20%20%20%20C%20--%3E%20D%5B%22Sets%20event.context.i18n.locale%22%5D%0A%20%20%20%20D%20--%3E%20E%5B%22Redirect%20Plugin%3Cbr%2F%3E06.redirect.ts%20(server)%22%5D%0A%20%20%20%20E%20--%3E%20F%7BNeeds%20redirect%3F%7D%0A%20%20%20%20F%20--%3E%7CYes%7C%20G%5B%22302%20sendRedirect%3Cbr%2F%3E(no%20page%20render)%22%5D%0A%20%20%20%20F%20--%3E%7CNo%7C%20H%5B%22Continue%20to%20render%22%5D%0A%0A%20%20%20%20B%20--%3E%7CClient%20SPA%7C%20I%5B%22Redirect%20Plugin%3Cbr%2F%3E06.redirect.ts%20(client)%22%5D%0A%20%20%20%20I%20--%3E%20J%5B%22useI18nLocale().getPreferredLocale()%22%5D%0A%20%20%20%20J%20--%3E%20K%7BNeeds%20redirect%3F%7D%0A%20%20%20%20K%20--%3E%7CYes%7C%20L%5B%22navigateTo()%22%5D%0A%20%20%20%20K%20--%3E%7CNo%7C%20M%5B%22Stay%20on%20page%22%5D%0A"})]),fallback:a(()=>[...e[1]||(e[1]=[l(" Loading... ",-1)])]),_:1})),e[4]||(e[4]=s(`<h3 id="server-side-no-flash" tabindex="-1">Server-Side (No Flash) <a class="header-anchor" href="#server-side-no-flash" aria-label="Permalink to &quot;Server-Side (No Flash)&quot;">‚Äã</a></h3><ol><li><strong>Nitro middleware</strong> (<code>i18n.global.ts</code>) runs first ‚Äî detects locale from URL, cookie, or <code>Accept-Language</code> header and sets <code>event.context.i18n.locale</code></li><li><strong>Redirect plugin</strong> (<code>06.redirect.ts</code>, server branch) checks if the current path needs a redirect using <code>i18nStrategy.getClientRedirect()</code> and issues a 302 <code>sendRedirect</code> <strong>before</strong> any page rendering occurs</li><li>This prevents the &quot;error flash&quot; where users briefly see a wrong page before redirect</li></ol><h3 id="client-side-spa-navigation" tabindex="-1">Client-Side (SPA Navigation) <a class="header-anchor" href="#client-side-spa-navigation" aria-label="Permalink to &quot;Client-Side (SPA Navigation)&quot;">‚Äã</a></h3><ol><li>After hydration (<code>app:mounted</code>), the redirect plugin reads locale from <code>useI18nLocale().getPreferredLocale()</code></li><li>Uses <code>i18nStrategy.getClientRedirect()</code> to check if redirect is needed</li><li>On SPA navigation (<code>router.afterEach</code>), re-checks for redirects</li></ol><h3 id="locale-priority-order" tabindex="-1">Locale Priority Order <a class="header-anchor" href="#locale-priority-order" aria-label="Permalink to &quot;Locale Priority Order&quot;">‚Äã</a></h3><p>The redirect plugin determines the preferred locale in this order:</p><ol><li><strong><code>useState(&#39;i18n-locale&#39;)</code></strong> ‚Äî highest priority (set programmatically via <code>useI18nLocale().setLocale()</code>)</li><li><strong>Cookie</strong> ‚Äî if <code>localeCookie</code> is configured</li><li><strong><code>Accept-Language</code> header</strong> ‚Äî if <code>autoDetectLanguage: true</code></li><li><strong><code>defaultLocale</code></strong> ‚Äî final fallback</li></ol><h3 id="redirect-behavior-per-strategy" tabindex="-1">Redirect Behavior Per Strategy <a class="header-anchor" href="#redirect-behavior-per-strategy" aria-label="Permalink to &quot;Redirect Behavior Per Strategy&quot;">‚Äã</a></h3><table tabindex="0"><thead><tr><th>Strategy</th><th><code>GET /</code> behavior</th><th>Cookie required?</th></tr></thead><tbody><tr><td><code>no_prefix</code></td><td>No redirect (locale from cookie/state)</td><td>Auto-set</td></tr><tr><td><code>prefix</code></td><td>302 ‚Üí <code>/{locale}/</code></td><td>Recommended</td></tr><tr><td><code>prefix_except_default</code></td><td>302 ‚Üí <code>/{locale}/</code> if locale ‚â† default</td><td>Recommended</td></tr><tr><td><code>prefix_and_default</code></td><td>No redirect (both <code>/</code> and <code>/{locale}/</code> valid)</td><td>Optional</td></tr></tbody></table><h3 id="disabling-redirects" tabindex="-1">Disabling Redirects <a class="header-anchor" href="#disabling-redirects" aria-label="Permalink to &quot;Disabling Redirects&quot;">‚Äã</a></h3><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  redirects</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Disables automatic locale redirects</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>When <code>redirects: false</code>, the redirect plugin (<code>06.redirect</code>) is still registered but only the redirect logic is disabled. The plugin continues to perform:</p><ul><li><strong>404 checks</strong> for invalid locale prefixes (e.g. <code>/xx/about</code> where <code>xx</code> is not a valid locale)</li><li><strong>Cookie synchronization</strong> from URL prefix (e.g. visiting <code>/fr/about</code> syncs the cookie to <code>fr</code>)</li></ul><h2 id="üç™-cookie-based-locale-persistence" tabindex="-1">üç™ Cookie-Based Locale Persistence <a class="header-anchor" href="#üç™-cookie-based-locale-persistence" aria-label="Permalink to &quot;üç™ Cookie-Based Locale Persistence&quot;">‚Äã</a></h2><div class="warning custom-block"><p class="custom-block-title">Required for prefix strategies with redirects</p><p>When using <code>prefix</code> or <code>prefix_except_default</code> with <code>redirects: true</code> (the default), you <strong>must</strong> set <code>localeCookie</code> for redirects to work correctly. Without a cookie, the redirect plugin cannot remember the user&#39;s locale preference across page reloads.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;prefix_except_default&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  localeCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user-locale&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Required for redirects to work properly</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></div><p><strong>How <code>localeCookie</code> works in v3:</strong></p><ul><li>Managed internally by <code>useI18nLocale()</code> ‚Äî <strong>do not set it manually</strong> via <code>useCookie()</code></li><li>When a user visits a prefixed URL (e.g., <code>/fr/about</code>), the cookie is automatically synced to <code>fr</code></li><li>On next visit to <code>/</code>, the cookie value is used to redirect to <code>/{locale}/</code></li><li>If the cookie contains an invalid locale (not in <code>locales</code> list), it falls back to <code>defaultLocale</code></li></ul><table tabindex="0"><thead><tr><th>Strategy</th><th><code>localeCookie</code> default</th><th>Notes</th></tr></thead><tbody><tr><td><code>no_prefix</code></td><td>Auto: <code>&#39;user-locale&#39;</code></td><td>Required; set automatically</td></tr><tr><td><code>prefix</code></td><td><code>null</code> (disabled)</td><td>Set to <code>&#39;user-locale&#39;</code> for redirects</td></tr><tr><td><code>prefix_except_default</code></td><td><code>null</code> (disabled)</td><td>Set to <code>&#39;user-locale&#39;</code> for redirects</td></tr><tr><td><code>prefix_and_default</code></td><td><code>null</code> (disabled)</td><td>Optional</td></tr></tbody></table><h2 id="üîç-autodetectlanguage-and-autodetectpath" tabindex="-1">üîç <code>autoDetectLanguage</code> and <code>autoDetectPath</code> <a class="header-anchor" href="#üîç-autodetectlanguage-and-autodetectpath" aria-label="Permalink to &quot;üîç \`autoDetectLanguage\` and \`autoDetectPath\`&quot;">‚Äã</a></h2><h3 id="autodetectlanguage" tabindex="-1"><code>autoDetectLanguage</code> <a class="header-anchor" href="#autodetectlanguage" aria-label="Permalink to &quot;\`autoDetectLanguage\`&quot;">‚Äã</a></h3><p>When <code>true</code>, the server middleware checks the <code>Accept-Language</code> header to detect the user&#39;s preferred locale. This is used as a fallback when no cookie or state is available.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  autoDetectLanguage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Default: true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="autodetectpath" tabindex="-1"><code>autoDetectPath</code> <a class="header-anchor" href="#autodetectpath" aria-label="Permalink to &quot;\`autoDetectPath\`&quot;">‚Äã</a></h3><p>Controls which paths trigger locale detection and redirect:</p><ul><li><code>&quot;/&quot;</code> (default) ‚Äî only the root path triggers detection/redirect</li><li><code>&quot;*&quot;</code> ‚Äî <strong>all paths</strong> trigger detection/redirect (use with caution)</li></ul><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">i18n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  autoDetectPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Default: only root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // autoDetectPath: &#39;*&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // All paths ‚Äî redirects even /fr/about to /de/about</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title"><code>autoDetectPath: &#39;*&#39;</code></p><p>With <code>autoDetectPath: &#39;*&#39;</code>, even URLs with an explicit locale prefix (e.g., <code>/fr/about</code>) will be redirected if the user&#39;s preferred locale differs. This can be useful for domain-based setups but may confuse users who share URLs.</p></div><h2 id="‚ö†Ô∏è-known-issues-and-best-practices" tabindex="-1">‚ö†Ô∏è Known Issues and Best Practices <a class="header-anchor" href="#‚ö†Ô∏è-known-issues-and-best-practices" aria-label="Permalink to &quot;‚ö†Ô∏è Known Issues and Best Practices&quot;">‚Äã</a></h2><h3 id="_1-hydration-mismatch-in-no-prefix-strategy" tabindex="-1">1. Hydration Mismatch in <code>no_prefix</code> Strategy <a class="header-anchor" href="#_1-hydration-mismatch-in-no-prefix-strategy" aria-label="Permalink to &quot;1. Hydration Mismatch in \`no_prefix\` Strategy&quot;">‚Äã</a></h3><p>When using <code>no_prefix</code>, the locale is determined dynamically. If server and client disagree on the locale, you&#39;ll see a hydration mismatch.</p><p><strong>Solution</strong>: Use <code>useI18nLocale().setLocale()</code> in a server plugin (with <code>order: -10</code>) to set the locale before i18n initialization:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// plugins/i18n-loader.server.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineNuxtPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;i18n-custom-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  enforce: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pre&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  order: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setLocale</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useI18nLocale</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setLocale</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ja&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Your detection logic here</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>See <a href="/nuxt-i18n-micro/guide/custom-auto-detect">Custom Language Detection</a> for detailed examples.</p><h3 id="_2-use-named-routes-with-localeroute" tabindex="-1">2. Use Named Routes with <code>localeRoute</code> <a class="header-anchor" href="#_2-use-named-routes-with-localeroute" aria-label="Permalink to &quot;2. Use Named Routes with \`localeRoute\`&quot;">‚Äã</a></h3><p>Path-based routing can cause issues with route resolution:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// May cause issues</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$localeRoute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/page&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Preferred approach</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$localeRoute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;page&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span></code></pre></div><h3 id="_3-using-pages-false-with-i18n" tabindex="-1">3. Using <code>pages: false</code> with i18n <a class="header-anchor" href="#_3-using-pages-false-with-i18n" aria-label="Permalink to &quot;3. Using \`pages: false\` with i18n&quot;">‚Äã</a></h3><p>When using Nuxt with <code>pages: false</code>:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineNuxtConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pages: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  i18n: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    strategy: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;no_prefix&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Recommended</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    disablePageLocales: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Required</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    localeCookie: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user-locale&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Required for persistence</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p><strong>Limitations with <code>pages: false</code>:</strong></p><ul><li>No automatic redirects</li><li>No URL-based locale detection</li><li>Client-side locale switching requires page reload or manual translation loading</li></ul><h3 id="_4-invalid-cookie-handling" tabindex="-1">4. Invalid Cookie Handling <a class="header-anchor" href="#_4-invalid-cookie-handling" aria-label="Permalink to &quot;4. Invalid Cookie Handling&quot;">‚Äã</a></h3><p>If a cookie contains an invalid locale (not in the <code>locales</code> list), the module gracefully falls back to <code>defaultLocale</code>. No errors are thrown.</p><h2 id="üìù-best-practices-summary" tabindex="-1">üìù Best Practices Summary <a class="header-anchor" href="#üìù-best-practices-summary" aria-label="Permalink to &quot;üìù Best Practices Summary&quot;">‚Äã</a></h2><table tabindex="0"><thead><tr><th>Recommendation</th><th>Details</th></tr></thead><tbody><tr><td><strong>Set <code>localeCookie</code></strong></td><td>Always set for prefix strategies with <code>redirects: true</code></td></tr><tr><td><strong>Use <code>useI18nLocale()</code></strong></td><td>The centralized way to manage locale state (replaces manual <code>useState</code>/<code>useCookie</code>)</td></tr><tr><td><strong>Use named routes</strong></td><td><code>$localeRoute({ name: &#39;page&#39; })</code> over <code>$localeRoute(&#39;/page&#39;)</code></td></tr><tr><td><strong>Programmatic locale</strong></td><td>Use <code>useI18nLocale().setLocale()</code> in a server plugin with <code>order: -10</code></td></tr><tr><td><strong>Avoid manual cookies</strong></td><td>Don&#39;t use <code>useCookie(&#39;user-locale&#39;)</code> directly ‚Äî <code>useI18nLocale()</code> manages this</td></tr></tbody></table>`,45))])}const x=d(p,[["render",k]]);export{F as __pageData,x as default};
